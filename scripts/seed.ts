import dbConnect from '../src/lib/db/mongodb'
import User from '../src/lib/models/User.model'
import Admin from '../src/lib/models/Admin.model'
import Job from '../src/lib/models/Job.model'
import News from '../src/lib/models/News.model'
import Application from '../src/lib/models/Application.model'
import bcrypt from 'bcryptjs'

async function seedDatabase() {
  try {
    console.log('üå± Starting database seeding...')
    
    await dbConnect()
    console.log('‚úÖ Connected to MongoDB')

    // Clear existing data
    await Promise.all([
      User.deleteMany({}),
      Admin.deleteMany({}),
      Job.deleteMany({}),
      News.deleteMany({}),
      Application.deleteMany({})
    ])
    console.log('üßπ Cleared existing data')

    // Create admin user
    const hashedAdminPassword = await bcrypt.hash('admin123', 12)
    const admin = await Admin.create({
      name: 'Admin User',
      email: 'admin@apnajourney.com',
      password: hashedAdminPassword,
      role: 'super-admin'
    })
    console.log('üë§ Created admin user')

    // Create sample users
    const hashedPassword = await bcrypt.hash('password123', 12)
    const users = await User.create([
      {
        name: 'Rajesh Kumar',
        email: 'rajesh@example.com',
        password: hashedPassword,
        phone: '9876543210',
        role: 'user',
        status: 'active'
      },
      {
        name: 'Priya Sharma',
        email: 'priya@example.com',
        password: hashedPassword,
        phone: '9876543211',
        role: 'user',
        status: 'active'
      },
      {
        name: 'Amit Singh',
        email: 'amit@example.com',
        password: hashedPassword,
        phone: '9876543212',
        role: 'user',
        status: 'active'
      }
    ])
    console.log('üë• Created sample users')

    // Create sample jobs
    const jobs = await Job.create([
      {
        title: 'Software Developer - React/Node.js',
        company: 'Tech Solutions Pvt Ltd',
        location: 'Gaya, Bihar',
        jobType: 'full-time',
        salary: '‚Çπ4,00,000 - ‚Çπ6,00,000 per year',
        description: 'We are looking for an experienced software developer with expertise in React and Node.js to join our growing team in Gaya.',
        requirements: [
          'Bachelor\'s degree in Computer Science or related field',
          '2+ years of experience with React and Node.js',
          'Experience with MongoDB and Express.js',
          'Good communication skills in Hindi and English'
        ],
        responsibilities: [
          'Develop and maintain web applications using React and Node.js',
          'Collaborate with cross-functional teams',
          'Write clean, maintainable code',
          'Participate in code reviews'
        ],
        postedBy: users[0]._id,
        status: 'active',
        applicationDeadline: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000) // 30 days from now
      },
      {
        title: 'Marketing Executive',
        company: 'Local Business Hub',
        location: 'Gaya, Bihar',
        jobType: 'full-time',
        salary: '‚Çπ2,50,000 - ‚Çπ3,50,000 per year',
        description: 'Join our marketing team to promote local businesses and help them grow in the Gaya market.',
        requirements: [
          'Bachelor\'s degree in Marketing or related field',
          '1+ years of marketing experience',
          'Good knowledge of digital marketing',
          'Fluent in Hindi and English'
        ],
        responsibilities: [
          'Develop marketing strategies for local businesses',
          'Manage social media accounts',
          'Organize promotional events',
          'Build relationships with clients'
        ],
        postedBy: users[1]._id,
        status: 'active',
        applicationDeadline: new Date(Date.now() + 25 * 24 * 60 * 60 * 1000) // 25 days from now
      },
      {
        title: 'English Teacher',
        company: 'Gaya Public School',
        location: 'Gaya, Bihar',
        jobType: 'part-time',
        salary: '‚Çπ15,000 - ‚Çπ20,000 per month',
        description: 'We need an experienced English teacher to teach students from classes 6-10.',
        requirements: [
          'Bachelor\'s degree in English or Education',
          'B.Ed. degree preferred',
          '2+ years of teaching experience',
          'Good communication skills'
        ],
        responsibilities: [
          'Teach English to students of classes 6-10',
          'Prepare lesson plans and assessments',
          'Maintain student records',
          'Participate in school activities'
        ],
        postedBy: users[2]._id,
        status: 'pending',
        applicationDeadline: new Date(Date.now() + 20 * 24 * 60 * 60 * 1000) // 20 days from now
      }
    ])
    console.log('üíº Created sample jobs')

    // Create sample news articles
    const newsArticles = await News.create([
      {
        title: 'New IT Park Inaugurated in Gaya',
        excerpt: 'A new IT park has been inaugurated in Gaya, promising to bring hundreds of job opportunities for local youth.',
        content: 'The new IT park in Gaya was inaugurated today by the Chief Minister of Bihar. This state-of-the-art facility is expected to create over 500 direct jobs and 1000+ indirect employment opportunities. The park will house various IT companies and startups, focusing on software development, digital marketing, and IT services. Local officials are optimistic that this will boost the economy of Gaya and surrounding areas.',
        featuredImage: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800&h=400&fit=crop',
        category: 'development',
        tags: ['IT', 'Jobs', 'Development', 'Gaya'],
        language: 'english',
        author: admin._id,
        status: 'published',
        isFeatured: true,
        publishedAt: new Date(),
        views: 150,
        seoTitle: 'New IT Park Inaugurated in Gaya - Job Opportunities',
        seoDescription: 'New IT park in Gaya inaugurated, creating 500+ job opportunities for local youth in software development and IT services.'
      },
      {
        title: '‡§ó‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§∏‡§°‡§º‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç',
        excerpt: '‡§ó‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§∏‡§°‡§º‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§π‡•Å‡§à ‡§π‡•à ‡§ú‡•ã ‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§ ‡§ï‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã ‡§ï‡§Æ ‡§ï‡§∞‡•á‡§ó‡•Ä‡•§',
        content: '‡§ó‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§ú ‡§è‡§ï ‡§®‡§à ‡§∏‡§°‡§º‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§π‡•Å‡§à ‡§π‡•à‡•§ ‡§á‡§∏ ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•á ‡§§‡§π‡§§ ‡§∂‡§π‡§∞ ‡§ï‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Æ‡§æ‡§∞‡•ç‡§ó‡•ã‡§Ç ‡§ï‡•ã ‡§ö‡•å‡§°‡§º‡§æ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§î‡§∞ ‡§®‡§à ‡§∏‡§°‡§º‡§ï‡•á‡§Ç ‡§¨‡§®‡§æ‡§à ‡§ú‡§æ‡§è‡§Ç‡§ó‡•Ä‡•§ ‡§Ø‡§π ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ 6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•ã‡§®‡•á ‡§ï‡•Ä ‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡§∏‡•á ‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§ ‡§ï‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§´‡•Ä ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§π‡•ã‡§ó‡§æ‡•§ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§®‡§ø‡§µ‡§æ‡§∏‡•Ä ‡§á‡§∏ ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§',
        featuredImage: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800&h=400&fit=crop',
        category: 'development',
        tags: ['‡§∏‡§°‡§º‡§ï', '‡§µ‡§ø‡§ï‡§æ‡§∏', '‡§ó‡§Ø‡§æ', '‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§'],
        language: 'hindi',
        author: admin._id,
        status: 'published',
        isFeatured: false,
        publishedAt: new Date(Date.now() - 24 * 60 * 60 * 1000), // 1 day ago
        views: 89,
        seoTitle: '‡§ó‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§∏‡§°‡§º‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç - ‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§ ‡§∏‡•Å‡§ß‡§æ‡§∞',
        seoDescription: '‡§ó‡§Ø‡§æ ‡§∂‡§π‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§∏‡§°‡§º‡§ï ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∂‡•Å‡§∞‡•Ç, 6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä ‡§î‡§∞ ‡§Ø‡§æ‡§§‡§æ‡§Ø‡§æ‡§§ ‡§ï‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡•ã ‡§ï‡§Æ ‡§ï‡§∞‡•á‡§ó‡•Ä‡•§'
      },
      {
        title: 'Local Business Expo 2024 in Gaya',
        excerpt: 'The annual business expo in Gaya will showcase local products and services, promoting entrepreneurship in the region.',
        content: 'Gaya is gearing up for its annual business expo scheduled for next month. This year\'s expo will feature over 100 local businesses showcasing their products and services. The event aims to promote entrepreneurship and provide a platform for local businesses to connect with customers and investors. Special sessions on digital marketing and e-commerce will also be conducted for participating businesses.',
        featuredImage: 'https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=800&h=400&fit=crop',
        category: 'business',
        tags: ['Business', 'Expo', 'Entrepreneurship', 'Gaya'],
        language: 'english',
        author: admin._id,
        status: 'published',
        isFeatured: false,
        publishedAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000), // 2 days ago
        views: 67,
        seoTitle: 'Local Business Expo 2024 in Gaya - Entrepreneurship',
        seoDescription: 'Annual business expo in Gaya featuring 100+ local businesses, promoting entrepreneurship and digital marketing.'
      }
    ])
    console.log('üì∞ Created sample news articles')

    // Create sample job applications
    const applications = await Application.create([
      {
        jobId: jobs[0]._id,
        userId: users[1]._id,
        coverLetter: 'I am very interested in this software developer position. I have 2 years of experience with React and Node.js and I am excited to contribute to your team.',
        resumeUrl: 'https://example.com/resume1.pdf',
        status: 'pending'
      },
      {
        jobId: jobs[1]._id,
        userId: users[2]._id,
        coverLetter: 'I have a strong background in marketing and I am passionate about helping local businesses grow. I would love to be part of your marketing team.',
        resumeUrl: 'https://example.com/resume2.pdf',
        status: 'pending'
      }
    ])
    console.log('üìù Created sample job applications')

    console.log('üéâ Database seeding completed successfully!')
    console.log('\nüìä Summary:')
    console.log(`- Admin users: 1`)
    console.log(`- Regular users: ${users.length}`)
    console.log(`- Jobs: ${jobs.length}`)
    console.log(`- News articles: ${newsArticles.length}`)
    console.log(`- Job applications: ${applications.length}`)
    console.log('\nüîë Login credentials:')
    console.log('Admin: admin@apnajourney.com / admin123')
    console.log('User: rajesh@example.com / password123')

  } catch (error) {
    console.error('‚ùå Error seeding database:', error)
    process.exit(1)
  }
}

// Run the seed function
seedDatabase()
  .then(() => {
    console.log('‚úÖ Seeding process completed')
    process.exit(0)
  })
  .catch((error) => {
    console.error('‚ùå Seeding process failed:', error)
    process.exit(1)
  })